local RunService = game:GetService("RunService") 
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")

-- Store original lighting settings
local originalLighting = {
    Ambient = Lighting.Ambient,
    OutdoorAmbient = Lighting.OutdoorAmbient,
    Brightness = Lighting.Brightness,
    FogColor = Lighting.FogColor,
    FogStart = Lighting.FogStart,
    FogEnd = Lighting.FogEnd,
}

-- Function to reset the lighting to original settings
local function resetLighting()
    -- Remove existing sky
    for _, child in pairs(Lighting:GetChildren()) do
        if child:IsA("Sky") then
            child:Destroy()
        end
    end

    -- Restore original lighting effects
    Lighting.Ambient = originalLighting.Ambient
    Lighting.OutdoorAmbient = originalLighting.OutdoorAmbient
    Lighting.Brightness = originalLighting.Brightness
    Lighting.FogColor = originalLighting.FogColor
    Lighting.FogStart = originalLighting.FogStart
    Lighting.FogEnd = originalLighting.FogEnd
end

-- Function to create colorful firework effects
local function createFireworks()
    local fireworkList = {}

    for i = 1, 60 do  -- Increased the number of fireworks
        local firework = Instance.new("Part")
        firework.Size = Vector3.new(1, 1, 1)
        firework.Position = Vector3.new(math.random(-100, 100), math.random(40, 100), math.random(-100, 100))
        firework.Anchored = true
        firework.CanCollide = false
        firework.Transparency = 1 -- Make the firework invisible
        firework.Name = "Firework"
        firework.Parent = workspace

        local particleEmitter = Instance.new("ParticleEmitter")
        particleEmitter.Color = ColorSequence.new(Color3.new(1, 0, 0), Color3.new(1, 1, 0), Color3.new(0, 1, 0), Color3.new(0, 1, 1), Color3.new(0, 0, 1), Color3.new(1, 0, 1))
        particleEmitter.Lifetime = NumberRange.new(1, 2)
        particleEmitter.Rate = 150
        particleEmitter.Speed = NumberRange.new(50, 100)
        particleEmitter.Size = NumberSequence.new(2, 5) -- Increased size of particles
        particleEmitter.Parent = firework

        coroutine.wrap(function()
            while firework do
                local hue = tick() % 5 / 5
                local color = Color3.fromHSV(hue, 1, 1)
                particleEmitter.Color = ColorSequence.new(color, Color3.new(math.random(), math.random(), math.random()))
                wait(0.1)
            end
        end)()

        table.insert(fireworkList, firework)
    end

    -- Sync fireworks with the song
    RunService.Heartbeat:Connect(function()
        for _, firework in ipairs(fireworkList) do
            local bobbingHeight = math.sin(tick() * 2) * 5
            firework.Position = firework.Position + Vector3.new(0, bobbingHeight, 0)
        end
    end)

    return fireworkList
end

-- Function to create a swirling particle effect
local function createSwirlingParticles()
    for i = 1, 20 do
        local swirlPart = Instance.new("Part")
        swirlPart.Size = Vector3.new(1, 1, 1)
        swirlPart.Position = Vector3.new(math.random(-50, 50), math.random(40, 100), math.random(-50, 50))
        swirlPart.Anchored = true
        swirlPart.CanCollide = false
        swirlPart.Transparency = 1 -- Make the swirl part invisible
        swirlPart.Parent = workspace

        local particleEmitter = Instance.new("ParticleEmitter")
        particleEmitter.Color = ColorSequence.new(Color3.new(1, 1, 1), Color3.new(0, 1, 1))
        particleEmitter.Lifetime = NumberRange.new(1, 3)
        particleEmitter.Rate = 200
        particleEmitter.Speed = NumberRange.new(30, 60)
        particleEmitter.Size = NumberSequence.new(0.5, 2)
        particleEmitter.Parent = swirlPart

        -- Swirl animation
        coroutine.wrap(function()
            while swirlPart do
                swirlPart.Position = swirlPart.Position + Vector3.new(math.sin(tick()), 0, math.cos(tick())) * 0.5
                wait(0.05)
            end
        end)()
    end
end

-- Function to create a colorful laser show
local function createLaserShow()
    for i = 1, 100 do
        local laser = Instance.new("Part")
        laser.Size = Vector3.new(0.1, 100, 0.1)
        laser.Position = Vector3.new(math.random(-100, 100), 50, math.random(-100, 100))
        laser.Anchored = true
        laser.CanCollide = false
        laser.BrickColor = BrickColor.Random()
        laser.Transparency = 1 -- Make the laser part invisible
        laser.Parent = workspace

        local tweenService = game:GetService("TweenService")
        local tweenInfo = TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1, true)
        local tween = tweenService:Create(laser, tweenInfo, {Size = Vector3.new(0.1, 0, 0.1)})
        tween:Play()
    end
end

-- Lighting Effects for Theme
Lighting.Ambient = Color3.fromRGB(255, 140, 0)
Lighting.OutdoorAmbient = Color3.fromRGB(10, 10, 10)
Lighting.Brightness = 2
Lighting.FogColor = Color3.fromRGB(255, 100, 0)
Lighting.FogStart = 200
Lighting.FogEnd = 800
local sky = Instance.new("Sky")
sky.SkyboxBk = "rbxassetid://159454299"
sky.SkyboxDn = "rbxassetid://159454299"
sky.SkyboxFt = "rbxassetid://159454299"
sky.SkyboxLf = "rbxassetid://159454299"
sky.SkyboxRt = "rbxassetid://159454299"
sky.SkyboxUp = "rbxassetid://159454299"
sky.Parent = Lighting

-- Sound Setup
local audioId = "rbxassetid://16190782786"
local sound = Instance.new("Sound")
sound.SoundId = audioId
sound.Looped = false
sound.Volume = 1
sound.Parent = workspace
sound:Play()

-- Create fireworks
local fireworkList = createFireworks()
createSwirlingParticles()  -- Create swirling particles
createLaserShow()          -- Create a laser show

-- Wait for the song to finish and then reset everything
sound.Ended:Wait()  -- Wait until the sound ends

-- Remove all fireworks, particles, lasers, and disco ball
for _, drop in pairs(workspace:GetChildren()) do
    if drop.Name == "Firework" or drop.Name == "DiscoBall" or drop:IsA("Part") then
        drop:Destroy()
    end
end

-- Reset lighting and remove all lighting effects
resetLighting()
